




/*
     FILE ARCHIVED ON 10:48:21 Jul 25, 2015 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 17:08:07 Aug 19, 2016.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
*/
define(["jquery","common/regexhelper/regexhelper","common/api/api.guid","libs/jquery/plugins/jquery.xDomainRequest"],function(e,s,i){function t(t,a,n,o,r){var l,u,m,c,d,h,v,f=this,p="form-button-disabled",g="form-value-invalid";this.cacheSelectors=function(){u=e("div#"+a),l=e("div#"+t),m=l.find('input[type="submit"]'),c=l.find('input[name="name"]'),d=l.find('input[name="email"]'),h=l.find('input[name="subject"]'),v=l.find('textarea[name="message"]')},this.isMobileView=function(){{var s="#mobile-site-view";e(s)}return e(s).length>0},this.hideSuccessMessage=function(){u.hide()},this.showSuccessMessage=function(){u.show(),u.parent().css("overflow","auto")},this.hideForm=function(){l.children(".form-body").hide()},this.showForm=function(){l.show()},this.wireUpClickEvent=function(){m.click(f.onSubmitClick)},this.removeInvalidCssFromInputs=function(){c.removeClass(g),d.removeClass(g),h.removeClass(g),v.removeClass(g)},this.addInvalidCssToInput=function(e){var s;switch(e){case"message":s=v;break;case"name":s=c;break;case"email":s=d;break;case"subject":s=h}s&&s.addClass(g)},this.getCurrentFormValues=function(){return{name:e.trim(c.val()),email:e.trim(d.val()),subject:e.trim(h.val()),message:e.trim(v.val())}},this.validateFormValues=function(e){var i=!0;return 0===e.name.length&&(i=!1,f.addInvalidCssToInput("name")),0===e.email.length?(i=!1,f.addInvalidCssToInput("email")):s.validateEmailAddress(e.email)||(i=!1,f.addInvalidCssToInput("email")),0===e.subject.length&&(i=!1,f.addInvalidCssToInput("subject")),0===e.message.length&&(i=!1,f.addInvalidCssToInput("message")),i},this.isButtonDisabled=function(){return m.hasClass(p)},this.toPascalCase=function(e){return null!=e&&void 0!=e&&(e=e.replace(/\w\S*/g,function(e){return e[0].toUpperCase()+e.slice(1).toLowerCase()})),e},this.sendFormPost=function(s){var t=[],a={name:"input",email:"email",subject:"input",message:"paragraph"};e.each(s,function(e,s){null!=a[e]&&t.push({label:f.toPascalCase(e),value:s,type:a[e]})});var n={domainName:r.domainName,resellerId:r.resellerId,elementId:i.toLegacyIdString(r.elementId),subject:r.subject,emailHashList:r.emailHashList,formFields:t,hostPageUrl:encodeURIComponent(window.location.href)},o=r.mailerUrl,l={type:"POST",url:o,crossDomain:!0,data:JSON.stringify(n),dataType:"json"},u=(s.name||"").split(),m=u[0],c=u.slice(1).join(" "),d={email:s.email,firstName:m,lastName:c,suppressed:"true"},h=[r.gemSubmitUrl,r.shopperId,r.domainName].join("/"),v={type:"POST",url:h,crossDomain:!0,data:d,dataType:"json"};e.when(e.ajax(l),e.ajax(v)).then(f.onSubmitSuccess).fail(f.onSubmitFailure)},this.setWindowLocation=function(e){window.location=e},this.onLoad=function(){f.cacheSelectors(),f.hideSuccessMessage(),f.showForm(),f.wireUpClickEvent()},this.onSubmitClick=function(){f.removeInvalidCssFromInputs();var e=f.getCurrentFormValues();f.validateFormValues(e)&&(f.isButtonDisabled()||(m.addClass(p),f.sendFormPost(e)))},this.onSubmitSuccess=function(){0===n?(f.hideForm(),f.showSuccessMessage()):f.setWindowLocation(o)},this.onSubmitFailure=function(s){m.removeClass(p);var i=r.sendErrorMessage,t=r.errorTitle,a="error";429===s.status&&r.tooManyRequestsErrorMessage&&(i=r.tooManyRequestsErrorMessage,r.tooManyRequestsErrorTitle&&(t=r.tooManyRequestsErrorTitle),a="warning"),f.isMobileView()?alert(i):e("<div></div>").sfGrowl({title:t||"",content:i,icon:a,fadetime:3e3})},this.init=function(){e(document).ready(f.onLoad)}}return t});
//# sourceMappingURL=form.js.map